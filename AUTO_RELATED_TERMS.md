# 自動顯示 Related Terms 更新 ✨

## 改進內容

### ✅ 移除了搜尋按鈕
- ❌ 之前：需要點擊 "Find Related Terms" 按鈕才會搜尋
- ✅ 現在：座標改變時自動搜尋

### ✅ 自動顯示機制
當你移動 crosshair 時（點擊圖片或輸入座標），系統會：

1. **500ms 防抖延遲** - 等待你完成調整
2. **自動開始搜尋** - 不需要點擊任何按鈕
3. **實時顯示進度** - 看到滑動載入條
4. **即時呈現結果** - Related Terms 自動出現

## 使用體驗

### 操作流程
```
1. 在腦圖上點擊任意位置 👆
   ↓
2. Crosshair 移動，座標更新 📍
   ↓
3. 等待 0.5 秒（防抖）⏱️
   ↓
4. 自動開始搜尋 🔍
   ↓
5. Related Terms 自動顯示 ✅
```

### 優勢
- **零點擊** - 完全自動化
- **即時反饋** - 移動就搜尋
- **流暢體驗** - 無需手動觸發
- **防抖機制** - 避免頻繁請求

## UI 變化

### Crosshair Position 控制區
```
┌─────────────────────────────────┐
│ Crosshair Position              │
├─────────────────────────────────┤
│ X (mm): [____]                  │
│ Y (mm): [____]                  │
│ Z (mm): [____]                  │
├─────────────────────────────────┤
│ Related Terms                   │
│ ┌─────────────────────────────┐ │
│ │ 🔄 Searching...             │ │
│ │ ────────────────────        │ │
│ └─────────────────────────────┘ │
│                                 │
│ 或                              │
│                                 │
│ ┌─────────────────────────────┐ │
│ │ ✓ 5 terms found             │ │
│ │ (0.0, 0.0, 0.0)            │ │
│ ├─────────────────────────────┤ │
│ │ term1                       │ │
│ │ term2                       │ │
│ │ term3                       │ │
│ │ ...                         │ │
│ └─────────────────────────────┘ │
└─────────────────────────────────┘
```

### 顯示狀態

#### 1. 初始狀態
- 不顯示 Related Terms 區塊
- 等待用戶調整座標

#### 2. 搜尋中
- 顯示 "Related Terms" 標題
- 滑動載入條動畫
- "Searching for related terms..." 提示

#### 3. 成功找到
- ✓ 圖標 + "X terms found"
- 顯示座標 (x, y, z)
- Terms 列表（可滾動，最高 200px）
- 每個 term hover 時高亮

#### 4. 未找到
- ⚠ 圖標 + 錯誤訊息
- 說明已檢查的 terms 數量
- 建議嘗試其他座標

## 技術實現

### 自動觸發機制
```javascript
useEffect(() => {
  // 500ms 防抖
  const timer = setTimeout(() => {
    // 自動搜尋邏輯
  }, 500)
  
  return () => clearTimeout(timer)
}, [cx, cy, cz, dims]) // 監聽座標變化
```

### 防抖策略
- **延遲**: 500ms
- **目的**: 避免頻繁 API 請求
- **效果**: 等待用戶完成座標調整

### 條件判斷
只在以下情況搜尋：
- ✅ 有效的 dims（已載入腦圖）
- ✅ 座標不是 (0, 0, 0)（初始狀態）

## 性能優化

### 請求控制
- 500ms 防抖，避免連續請求
- 檢查前 100 個 terms（可調整）
- 每個 API 3 秒超時
- 10mm 搜尋半徑

### 用戶體驗
- 搜尋期間顯示進度動畫
- 錯誤時給予明確提示
- 結果列表可滾動
- Hover 動畫流暢

## 與之前的對比

### 之前的版本
```
1. 調整座標
2. 點擊 "Find Related Terms" 按鈕 ← 需要手動
3. 等待搜尋
4. 查看結果
```

### 現在的版本
```
1. 調整座標
2. 等待 0.5 秒（自動開始）← 完全自動
3. 查看結果
```

**節省操作**: 每次省略 1 次點擊
**體驗提升**: 100% 自動化

## 適用場景

### 探索模式
快速點擊不同腦區，立即看到相關 terms

### 精確模式
輸入文獻中的座標，自動查看關聯功能

### 比較模式
在不同位置間切換，即時比較 terms 差異

## 注意事項

### 搜尋時間
- 每次搜尋約 30-60 秒
- 請耐心等待完成
- 載入動畫顯示進度

### 防抖機制
- 快速連續移動時，只會執行最後一次搜尋
- 節省 API 資源

### 初始狀態
- 座標為 (0, 0, 0) 時不會自動搜尋
- 避免無意義的初始查詢

---

## 總結

這次更新實現了：
- ✅ 完全自動化的 related terms 查詢
- ✅ 移除了不必要的按鈕
- ✅ 更流暢的用戶體驗
- ✅ 智能的防抖機制

現在使用者只需專注於探索腦圖，系統會自動處理其他一切！🚀
